<!DOCTYPE html>
<html lang="en">
    <head>
    <title>Cleaning Lady Notes: From Class Mess to PSR-4 Step by Step With Confidence | Tomas Votruba</title>
    <meta charset="utf-8">
    <meta name="robots" content="index, follow">

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">

    
    <link rel="alternate" type="application/rss+xml" title="Tomas Votruba Blog RSS" href="/rss.xml">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">

        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/solid.css" integrity="sha384-wnAC7ln+XN0UKdcPvJvtqIH3jOjs9pnKnq9qX68ImXvOGz2JuFoEiCjT8jyZQX2z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/brands.css" integrity="sha384-nT8r1Kzllf71iZl81CdFzObMsaLOhqBU1JD2+XoAALbdtWaXDOlWOZTR4v1ktjPE" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css" integrity="sha384-HbmWTHay9psM8qyzEKPc8odH4DsOuzdejtnr+OFtDmOcIVnhgReQ4GZBH7uwcjf6" crossorigin="anonymous">

        <link href="/assets/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css" />

    <link href="/assets/prism/prism.css" rel="stylesheet" type="text/css" />

        <link href="/assets/css/style.css" rel="stylesheet" type="text/css" />


        <link href="/assets/css/checklist.css" rel="stylesheet" type="text/css" />
</head>
    <body>
                <!-- post_id: 267 -->

        
<div class="hidden-sm-down">
    <nav class="navbar">
        <div class="container-fluid">
            <ul>
                <li id="logo">
                    <img src="https://avatars1.githubusercontent.com/u/924196?s=60&v=4" class="me_avatar">
                    Tomas Votruba
                </li>
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li class="">
                    <a href="/php-framework-trends">Trends</a>
                </li>
                <li class="">
                    <a href="/clusters">Clusters</a>
                </li>
                <li class="">
                    <a href="/projects">Projects</a>
                </li>
                <li class="">
                    <a href="/mission">Mission</a>
                </li>
                <li class="">
                    <a href="/talks">Talks</a>
                </li>
                <li class="">
                    <a href="/contact">Contact</a>
                </li>
                <li id="top-menu-search">
                    <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction">
    <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
    <input name="sitesearch" value="tomasvotruba.com" type="hidden"/>
    <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search..." autocomplete="off"/>
</form>
                </li>
            </ul>
        </div>
    </nav>
</div>

<div class="hidden-md-up">
    <nav class="navbar" id="mobile-menu">
        <div class="container">
            <a href="/" class="col-3 col-sm-3 active">
                <em class="fas fa-book"></em>
                <br>
                Blog
            </a>


            <a href="/clusters" class="col-3 col-sm-3 ">
                <em class="fas fa-share-alt"></em>
                <br>
                Clusters
            </a>

            <a href="/projects" class="col-3 col-sm-3 ">
                <em class="fas fa-chart-bar"></em>
                <br>
                Trends
            </a>

            <a href="/contact" class="col-3 col-sm-3 ">
                <em class="fas fa-phone"></em>
                <br>
                Contact
            </a>
        </div>
    </nav>

    <div class="hidden-md-up text-center" id="top-menu-search-mobile">
        <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction">
    <meta itemprop="target" content="https://www.google.com/search?q={q}"/>
    <input name="sitesearch" value="tomasvotruba.com" type="hidden"/>
    <input itemprop="query-input" type="text" id="search-query" class="form-control" required="required" name="q" placeholder="Search..." autocomplete="off"/>
</form>
    </div>
</div>

        <div class="mainContent">
            <div class="container-fluid" id="post">
                <h1>Cleaning Lady Notes: From Class Mess to PSR-4 Step by Step With Confidence</h1>

                <ul class="list-inline post-metadata">
    <li class="list-inline-item mr-3">
        <em class="fas fa-clock fa-fw"></em>
        <strong>5 min</strong>
    </li>

    <li class="list-inline-item mr-3">
        <em class="fas fa-calendar fa-fw"></em>
        <time datetime="2020-07-Mon">
            <strike>
                            Mon, Jul 6
            
            </strike>        </time>
    </li>

            <li class="list-inline-item mr-3 text-success">
            <em class="fas fa-fw fa-sync"></em> Updated Aug, 2020
        </li>
    
            <li class="list-inline-item mr-3">
            <em class="fas fa-fw fa-comments"></em>
            <a href="/blog/2020/07/06/cleaning-lady-notes-from-class-mess-to-psr4-step-by-step-with-confidence/#disqus_thread">X</a> comments
        </li>
    
    
            <li class="list-inline-item mr-3 text-primary">
            <em class="fab fa-fw fa-github"></em>
            <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/master/packages/blog/config/data/2020/2020-07-06-cleaning-lady-notes-from-class-mess-to-psr4-step-by-step-with-confidence.md">Edit Post</a>
        </li>
    </ul>

                
                                    <div class="card border-success card-bigger mt-5">
                        <div class="card-header text-white bg-success">
                            <strong>This post was updated at August 2020</strong>
                        </div>
                                                    <div class="card-body">
                                <p>Updated Rector YAML to PHP configuration, as current standard.</p>
                            </div>
                                            </div>

                    <br>
                
                <div class="card card-bigger mb-5">
                    <div class="card-body">
                        <p>Today I'm starting a new post series - <em>Cleaning Notes</em>. These posts are for people who are <a href="/blog/2020/06/29/how-will-programming-look-like-in-2025/">aspiring legacy migrators</a> with a vision to improve private PHP ecosystem and bring joy to coding with gigantic applications again. The same vision we have in the Rector team.
<br><br>
In this series, you can learn about my experience, tricks, tips, and what fucked me up. So you <strong>save some frustration, where is not needed, discover hidden shortcuts and cool tools you never saw before</strong>.
<br><br>
We start with the most problematic topic in PHP legacy, that every project needs, but almost none has - <strong>transition to <a href="https://www.php-fig.org/psr/psr-4">PSR-4</a></strong>.</p>
                    </div>
                </div>

                <p><em>Dedicated to <a href="https://github.com/Kerrialn">Kerrial</a>, my great friend who teaches me so much about not giving a f_ck and just do the stuff.<br>Thanks, dude!</em></p>
<p><br></p>
<h2 id="how-to-approach-the-migration-itself">How to Approach the Migration Itself?</h2>
<h3 id="know-your-enemy">Know Your Enemy</h3>
<p>There are many use cases that we have to handle to get to PSR-4. Honestly, I find it easier to <a href="/blog/2019/08/26/how-we-migrated-54-357-lines-of-code-nette-to-symfony-in-2-people-under-80-hours/">switch a framework</a>, where start is clear and goal is clear.</p>
<p>In PSR-4 migration, we have a clear goal:</p>
<ul>
<li>PSR-4: in 1 file, there is 1 class/trait/interface</li>
<li>the class/trait/interface has a unique fully qualified name, that reflects file location</li>
<li>nothing else exists</li>
</ul>
<h3 id="start-has-many-ugly-forms">Start has Many Ugly Forms</h3>
<ul>
<li><strong>in 1 file, there is a dozen classes</strong> - very popular for exceptions or test fixtures</li>
<li>some classes have <strong>identical name</strong> and custom class loader gives one or the other preference (e.g., Magento and Drupal use this in some version)</li>
<li>there are classes without any namespace</li>
<li>there are classes with <code>Fake_Namespace</code></li>
<li>file has a different name than the class, e.g. <code>random_file.php</code> with <code>class SomeClass {}</code> in it</li>
<li>in 1 file, there are classes and functions, so the file has to be manually included to &quot;autoload&quot; the functions</li>
<li>there are conditional classes, e.g.</li>
</ul>
<pre><code class="language-php">if (! class_exists('SomeClass')) {
    final class SomeClass
    {
        // ...
    }
}</code></pre>
<p>A lot to suck in, right? Don't worry; each of them has a guide to follow.</p>
<h3 id="low-hanging-fruit">Low Hanging Fruit</h3>
<p>Each project is different, some of them has <a href="/blog/2020/04/13/how-to-migrate-spaghetti-to-304-symfony-5-controllers-over-weekend/">functions mixed with HTML</a>, some is missing composer completely, some needs to <a href="/blog/2020/06/08/drop-robot-loader-and-let-composer-deal-with-autoloading/">switch from custom-framework autoloading</a>.</p>
<p>But you should always apply basic rule:</p>
<blockquote class="blockquote text-center mt-5 mb-5">
    "Take the low hanging fruit first."
</blockquote>
<p>Always <strong>go for a simple target first</strong>. Don't be a hero. A hero falls from the sky after a massive battle over Atlantic, forgot to charge his smartphone... and dies alone.</p>
<p><strong>Be professional, close quickly, close early</strong>. Are there 3 files with 20 classes in them?</p>
<ul>
<li>split them to 20 classes</li>
<li>don't deal with namespaces, don't care about file naming</li>
<li>create pull-request</li>
<li>merge it</li>
</ul>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<p>Done. You've just made a first small step. Cross <a href="/cleaning-lady-checklist">one step of your list</a>, 9/10 is left.
But all those 9 steps are now 10 % less complicated.</p>
<blockquote class="blockquote text-center mt-5 mb-5">
    "Even if you die, the code you wrote is merged."
    <footer class="blockquote-footer text-center">Bus Boy Scout Factor</footer></blockquote>
<p>I love this coding principle. Why? Because it takes minimalism and productivity to the practical world. It narrows our focus, so any developer becomes a 10x programmer effortlessly.</p>
<p><br></p>
<h2 id="what-exactly-to-do-case-study">What Exactly to Do? - Case Study</h2>
<p>Enough theory. <strong>Let's look at the project we've recently migrate to PSR-4 and how exactly we did it</strong>.</p>
<p>This is not paid promo, but <a href="https://www.startupjobs.cz/en/startup/scrumworks-s-r-o">Amateri are hiriging</a>. We're far enough with the migration, so I'm confident it would be fun to work with such codebase.</p>
<h2 id="1-split-multiple-classes-in-1-file">1. Split Multiple Classes in 1 File</h2>
<p>How does it look?</p>
<pre><code class="language-diff"> // SomeFile.php
 class SomeClass
 {
 }

 class AnotherClass
 {
 }</code></pre>
<pre><code class="language-diff">+// AnotherClass.php
+class AnotherClass
+{
+}</code></pre>
<p><br></p>
<p>The <strong>1st cool tool</strong> we look at today is <a href="https://github.com/migrify/psr4-switcher">migrify/psr4-switcher</a>.
It doesn't need projects' autoloader so that it can be installed outside the project, e.g., in <code>/var/www/tools</code>, while your project is in <code>/var/www/old_project</code>.</p>
<p>Install it:</p>
<pre><code class="language-bash">composer require migrify/psr4-switcher --dev</code></pre>
<p>It would be great to have a list of all such multi-class files, right?</p>
<pre><code class="language-bash">vendor/bin/psr4-switcher find-multi-classes /src</code></pre>
<p>↓</p>
<pre><code class="language-bash">* SomeFile.php
    * SomeClass
    * AnotherClass</code></pre>
<p>Now we know how big a problem we're dealing with.</p>
<ul>
<li>Are there 3 files with 20 classes? <strong>Separate them manually</strong>.</li>
<li>Is that 50 files with 300 classes? Use <strong>Rector rule</strong> - <a href="https://github.com/rectorphp/rector/blob/master/docs/rector_rules_overview.md#multipleclassfiletopsr4classesrector"><code>MultipleClassFileToPsr4ClassesRector</code></a>.</li>
</ul>
<p>Now 1 file has exactly 1 class/interface/trait.</p>
<p>Send pull request, make sure your project's autoloader autoloads them, and tests are passing. Merge it, and you're done.</p>
<h2 id="2-check-class-short-name-vs-filename">2. Check Class Short name vs. Filename</h2>
<pre><code class="language-diff"> // Cucumber.php
-class Car
+class Cucumber
 {
 }</code></pre>
<p>If we only knew how many such files are there and where... back to PSR4-Switcher:</p>
<pre><code class="language-bash">vendor/bin/psr4-switcher check-file-class-name src</code></pre>
<p>You will get a list of files that don't match. Use PHPStorm refactoring to change the class name everywhere:</p>
<img src="/assets/images/posts/2020/psr4_rename_class.gif" class="img-thumbnail">
<p>Commit, PR, CI passes, merge.</p>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<h2 id="3-upper-case-directories-first-letter">3. Upper-case Directories First Letter</h2>
<p>In PSR-4, any non-root directory must start with the first big letter. Root is e.g. <code>/app</code>, <code>/src</code>.</p>
<pre><code class="language-diff">-/app/form/someForm
+/app/Form/SomeForm</code></pre>
<p>Go through directory in the left panel in PHPStorm and rename the directories there:</p>
<img src="/assets/images/posts/2020/psr4_rename_dirs.gif" class="img-thumbnail">
<p>Commit, PR, CI passes, merge.</p>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<h2 id="4-check-psr-4-root">4. Check PSR-4 root</h2>
<p>We've done 3 steps so far. Now comes the biggest one, actually adding PSR-4 roots to <code>composer.json</code>.</p>
<p>It will not be as pretty as 1 root line, but that's not what we go here now. Our goal is <strong>to have all classes loaded with PSR-4, no matter how many lines</strong> in <code>composer.json</code> does it need.</p>
<pre><code class="language-json">{
    "autoload": {
        "psr-4": {
            "Amateri\\Payment\\": "src/somewhere-else/Payment",
            "Amateri\\Delivery\\": "src/another-dir/Delivery"
        }
    }
}</code></pre>
<p>We can guess what namespace roots (<code>"Amateri\\Payment\\"</code>) should be loaded from which directory (<code>"src/somewhere-else/Payment"</code>)... or we can use science!</p>
<pre><code class="language-bash">vendor/bin/psr4-switcher generate-psr4-paths project/src --composer-json project/composer.json</code></pre>
<p>The command will generate such paths for us, based on existing namespaces and file locations.
There may be over 10 or even 50 of those. <strong>Don't worry about it now</strong>.</p>
<ul>
<li>put generated output to <code>composer.json</code> instead of <code>classmap</code>,</li>
<li>run <code>composer dump-autoload</code> to let composer know about news paths</li>
<li>run PHPStan to see if all classes are loaded</li>
</ul>
<p>If everything passes... Commit, PR, CI passes, merge.</p>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<h2 id="5-narrow-the-namespace-root-and-directories-in-code-composer-json-code">5. Narrow the Namespace Root and Directories in <code>composer.json</code></h2>
<p>Now comes my favorite part. Here we move all directories <strong>to use as little namespace root as possible</strong>.</p>
<p>It might be a little bit unclear, but give it time and it will fit in. Let's look at the example:</p>
<pre><code class="language-diff"> {
     "autoload": {
         "psr-4": {
-            "Amateri\\Payment\\": "src/somewhere-else/Payment",
-            "Amateri\\Delivery\\": "src/another-dir/Delivery",
+            "Amateri\\": "src"
        }
    }
}</code></pre>
<p>What happens with files?</p>
<pre><code class="language-diff">-src/somewhere-else/Payment
+src/Payment</code></pre>
<pre><code class="language-diff">-src/another-dir/Delivery
+src/Delivery</code></pre>
<p>Here use PHPStorm refactoring on the directory as in step 3.</p>
<ul>
<li>run <code>composer dump-autoload</code> to let composer know about news paths</li>
<li>run PHPStan to see if all classes are loaded</li>
</ul>
<p>If everything passes... Commit, PR, CI passes, merge.</p>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<h2 id="6-what-if-there-are-no-namespaces-or-are-very-very-bad">6. What if there are No Namespaces or Are Very Very Bad?</h2>
<p>In many codebases, there are just random files—no namespace, no fake namespace, etc.</p>
<p>For these, we have help of Rector with these 2 rules:</p>
<ul>
<li><a href="https://github.com/rectorphp/rector/blob/master/docs/rector_rules_overview.md#normalizenamespacebypsr4composerautoloadfilesystemrector"><code>NormalizeNamespaceByPSR4ComposerAutoloadRector</code></a></li>
<li><a href="https://github.com/rectorphp/rector/blob/master/docs/rector_rules_overview.md#normalizenamespacebypsr4composerautoloadrector"><code>NormalizeNamespaceByPSR4ComposerAutoloadFileSystemRector</code></a></li>
</ul>
<p><br></p>
<p>Register them in <code>rector.php</code>:</p>
<pre><code class="language-php">&lt;?php

// rector.php

declare(strict_types=1);

use Rector\PSR4\Rector\FileSystem\NormalizeNamespaceByPSR4ComposerAutoloadFileSystemRector;
use Rector\PSR4\Rector\Namespace_\NormalizeNamespaceByPSR4ComposerAutoloadRector;
use Symfony\Component\DependencyInjection\Loader\Configurator\ContainerConfigurator;

return function (ContainerConfigurator $containerConfigurator): void {
    $services = $containerConfigurator-&gt;services();
    $services-&gt;set(NormalizeNamespaceByPSR4ComposerAutoloadRector::class);
    $services-&gt;set(NormalizeNamespaceByPSR4ComposerAutoloadFileSystemRector::class);
};</code></pre>
<p>And <strong>manually add the desired namespace</strong> to your <code>composer.json</code>:</p>
<pre><code class="language-diff"> {
+   "autoload": {
+        "psr-4": {
+            "Amateri\\": "src"
+        }
+    }
 }</code></pre>
<p>When you run the Rector, it will try to autocomplete all the namespaces to respect your <code>composer.json</code>:</p>
<pre><code class="language-bash">vendor/bin/rector p src</code></pre>
<p>This is one of <strong>the most significant changes in your application</strong>, so <strong>be sure to check it carefully</strong>. Not all cases are covered by Rector yet.</p>
<ul>
<li>run <code>composer dump-autoload</code> to let composer know about news paths</li>
<li>run PHPStan to see if all classes are loaded</li>
</ul>
<p>If everything passes... Commit, PR, CI passes, merge.</p>
<p><em class="fas fa-fw fa-check text-success fa-2x"></em></p>
<p><br></p>
<p>Then we added few manual tweaks here and there, and we were PSR-4 compliant with ~7 lines in PSR-4 in <code>composer.json</code>.</p>
<p><br></p>
<p><strong>Have you found a case that is not covered or a better way to this</strong>? Let me know in the comments.</p>
<p><br></p>
<p>Happy coding!</p>

                <br>

                <div class="row mb-5 mt-5">
                    <div class="col-12 mb-5">
                                                                            <a href="/blog/2020/07/02/how-to-patch-package-in-vendor-yet-allow-its-updates" class="d-block pt-4 pb-4 pl-4 pr-4 btn btn-success btn-wrappable">
                                <em class="fas fa-fw fa-forward"></em>
                                <strong>Read Next</strong>
                                <br>
                                <span class="text-bigger">
                                    How to Patch a Package in Vendor, Yet Allow its Updates
                                </span>
                            </a>
                                            </div>

                    <div class="col-12">
                        <a href="https://github.com/tomasvotruba/tomasvotruba.com/edit/master/packages/blog/config/data/2020/2020-07-06-cleaning-lady-notes-from-class-mess-to-psr4-step-by-step-with-confidence.md" class="d-block btn btn-dark btn-wrappable">
                            <em class="fab fa-fw fa-github"></em>
                            <strong>Found a typo?</strong> Fix it and join team of 99&nbsp;contributors
                        </a>
                    </div>
                </div>

                <br>

                <a name="comments"></a>
                <div id="disqus_thread"></div>

<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://itsworthsharing.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
            </div>

            <script id="dsq-count-scr" src="https://itsworthsharing.disqus.com/count.js" async defer></script>
        </div>

        <script src="/assets/js/jquery-3.3.1.slim.min.js"></script>
<script src="/assets/js/cluster-checklist.js"></script>
<script src="/assets/js/cluster-expanable.js"></script>

<script src="/assets/js/cleaning-lady-checklist.js"></script>

<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>

<script>
    ga=function(){ ga.q.push(arguments) };
    ga.q=[];
    ga.l=+new Date;
    ga('create', 'UA-46082345-1', 'auto');
    ga('send','pageview');
</script>
<script src="https://www.google-analytics.com/analytics.js" async defer></script>

<script src="/assets/prism/prism.js"></script>

<script>
    // sortable table
    $('.sortable_table').DataTable({
        // see https://datatables.net/examples/basic_init/filter_only.html
        "searching": false,
        "paging": false,
        "info": false,
        "order": [[1, "desc"]],
        // see https://datatables.net/examples/advanced_init/sort_direction_control.html
        "aoColumns": [
            null,
            { "orderSequence": [ "desc", "asc" ] },
            { "orderSequence": [ "desc", "asc" ] },
            { "orderSequence": [ "desc", "asc" ] }
        ]
    });
</script>

<div class="text-center mt-5" id="footer">
    <p>
        Thank you <a href="/thank-you">99 people</a>, who contributed this blog

        <span class="pl-2 pr-2">•</span>

        See <a href="/archive">Post Archive</a>
    </p>

    <br>

    <p>
        Did you know my daily focus goes to <strong>turning working with legacy code into joy</strong> again?

        <br>

        Mostly with awesome <a href="https://getrector.org/">instant refactoring tool called Rector</a>.
    </p>
</div>
    </body>
</html>

        <meta property="og:type" content="article" />
    <meta property="og:title" content="Cleaning Lady Notes: From Class Mess to PSR-4 Step by Step With Confidence" />
    <meta property="og:description" content="Today I&#039;m starting a new post series - *Cleaning Notes*. These posts are for people who are [aspiring legacy migrators](/blog/2020/06/29/how-will-programming-look-like-in-2025/) with a vision to improve private PHP ecosystem and bring joy to coding with gigantic applications again. The same vision we have in the Rector team.

In this series, you can learn about my experience, tricks, tips, and what fucked me up. So you **save some frustration, where is not needed, discover hidden shortcuts and cool tools you never saw before**.

We start with the most problematic topic in PHP legacy, that every project needs, but almost none has - **transition to [PSR-4](https://www.php-fig.org/psr/psr-4)**.
" />
    <meta property="og:url" content="/blog/2020/07/06/cleaning-lady-notes-from-class-mess-to-psr4-step-by-step-with-confidence" />

        <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@votrubaT">
    <meta name="twitter:title" content="Cleaning Lady Notes: From Class Mess to PSR-4 Step by Step With Confidence" />
    <meta name="twitter:description" content="Today I&#039;m starting a new post series - *Cleaning Notes*. These posts are for people who are [aspiring legacy migrators](/blog/2020/06/29/how-will-programming-look-like-in-2025/) with a vision to improve private PHP ecosystem and bring joy to coding with gigantic applications again. The same vision we have in the Rector team.

In this series, you can learn about my experience, tricks, tips, and what fucked me up. So you **save some frustration, where is not needed, discover hidden shortcuts and cool tools you never saw before**.

We start with the most problematic topic in PHP legacy, that every project needs, but almost none has - **transition to [PSR-4](https://www.php-fig.org/psr/psr-4)**.
" />
